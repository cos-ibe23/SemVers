FROM node:20-alpine

# Install postgresql-client for pg_isready
RUN apk add --no-cache postgresql-client

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .

# Make startup script executable
RUN chmod +x scripts/docker-start.sh

EXPOSE 4000
CMD ["sh", "scripts/docker-start.sh"]
